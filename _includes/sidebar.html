<!--
lvl1 = topnav button name (e.g. "articles" or "books")
lvl2 = sidebar name (same as topnav dropdown list entry, (e.g. "book 1" or "article 2")
lvl3 = 1st level of entries in sidebar  (eg section or chapter)
lvl4 = 2nd level of entries in sidebar  (eg chapter or page )
lvl5 = 3rd level of entries in sidebar  (e.g  page or sub-page)
-->

<div class="medianav">
{% include social_media_icons.html %}
</div>
<!-- <div class="mydocsidebar"> -->
   <div class="mencknav">
      {% unless page.url contains 'index.html' %}
         <!-- Get a list of all pages with l1/l2 index values that match *this* page.  (these are *all* the pages that should be in the sidebar)  -->
         {% assign ourpages = site.pages | where: 'l1idx', page.l1idx | where: 'l2idx', page.l2idx | where: '12name', null %}

         {% for heynong in ourpages %}
            {% if heynong.l1idx == page.l1idx and heynong.l2idx == page.l2idx and != heynong.l3idx and != heynong.l4idx %}
               {% assign progenitorpage = ourpages[forloopindex0] %}
            {% endif %}
         {% endfor %}       

         {% assign sbtitle = progenitor.title %}
         {% assign sburl = progenitor.url %}
         <div class="productTitle" style="padding-top: 32px;"><p>{{sbtitle}}</p></div>
      {% endunless %}
      {% unless page.url contains 'index.html' %}
            <!-- start building the tree if there *are* any other pages that match *this* page's l1|2 index values. -->
            {% if ourpages.size > 0 %}
               <!-- Get a list of all the unique/sorted l3 indices from sbpages -->
               {% assign ourl3idxes = ourpages | where_exp: 'page', 'page.l3name' | sort: 'l3idx' | map: 'l3idx' %}
               <!-- Loop through all the unique L3 indices and create the first level entries in the sidebar menu -->
               {% if ourl3idxes.size > 0 %}
                  {% for l3ix in ourl3idxes %}
                     <!-- Get a list of all the pages with *current* L3 index -->
                     {% assign myl3pages = ourpages | where: 'l3idx', l3ix | sort: 'l3idx' %}
                     <!-- set variables for the l3name and url value that corresponds to the l3index value of the current iteration of the loop -->
                     {% assign myl3name = myl3pages | where: 'l3idx', l3ix | where_exp: 'page', 'page.l3name' | map: 'l3name'%}
                     {% assign myl3url = myl3pages | where: 'l3name', myl3name[0] | map: 'url' | array_to_sentence_string %}
                     <!-- Get all the unique L4 indices in pages with *current* L3 index -->
                     {% assign myl4idxes = myl3pages | where_exp: 'page', 'page.l4name' | sort: 'l4idx' | map: 'l4idx' %}
                     <!-- Testing to see if the current l3 index has any l4 children. -->
                     {% if myl4idxes.size > 0 %}
                        <details class="sbdeet" {% if page.l3idx == l3ix%}open{%endif%}><summary><a title="{{myl3name}}" href="{{myl3url | remove: '/'}}">{{myl3name}}</a></summary>
                           {% for l4ix in myl4idxes %}
                              <!-- Get a list of all the pages with *current* L4 index -->
                              {% assign myl4pages = myl3pages | where: 'l4idx', l4ix %}
                              {% assign myl4name = myl4pages | where: 'l4idx', l4ix | where_exp: 'page', 'page.l4name' | map: 'l4name' %}
                              {% assign myl4url  = myl4pages | where: 'l4name', myl4name[0] | map: 'url' | array_to_sentence_string %}
                              <!-- Get all the unique L5 indices in pages with *current* L3&L4 index -->
                              {% assign myl5idxes = myl4pages | where_exp: 'page', 'page.l5name'| map: 'l5idx' %}
                              {% if myl5idxes.size > 0 %}
                                 <details class="sbdeet deet4" {% if page.l4idx == l4ix and page.l3idx == l3ix %} open{%endif%}><summary><a title="{{myl4name}}" href="{{myl4url | remove: '/'}}">{{myl4name}}</a></summary>
                                    {% for l5ix in myl5idxes %}
                                       {% assign myl5name = myl4pages | where: 'l5idx', l5ix | map: 'l5name' %}
                                       {% assign myl5url = myl4pages | where: 'l5name', myl5name[0] | map: 'url' %}
                                       <p class="l5item{% if page.l5idx == l5ix and page.l4idx == l4ix and page.l3idx == l3ix %}active{%endif%}"><a title="{{myl5name}}" href="{{myl5url[0] | remove: '/'}}">{{myl5name}}</a></p>
                                    {% endfor %}
                                 </details>
                              {% else %}
                                 <p class="l4item{% if page.l4idx == l4ix and page.l3idx == l3ix %}active{% endif %}"><a title="{{myl4name}}" href="{{myl4url | remove: '/'}}">{{myl4name}}</a></p>
                              {% endif %}
                           {% endfor %}
                        </details>
                     {% else %}
                        <p class="l3item{% if page.l3idx == l3ix %}active{% endif %}"><a title=" {{myl3name}}" href="{{myl3url | remove: '/'}}">{{myl3name}}</a></p>
                     {% endif %}
                  {% endfor %}
               {% else %}
                  <p> Nothing here yet; check back later</p>
               {% endif %}
            {% else %}
               <p> Nothing here yet; check back later</p>
            {% endif %}   
      {% endunless %}
   </div>
   <div class="mencknav">
      {% include in-page-nav-buttons.html %}
   </div>
<!-- </div> -->