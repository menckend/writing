
<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">{{page.libname}}</li>
  {% assign thesedocs = site.pages | where: 'libname', page.libname | map: 'docname' | uniq | compact %}
  {% for adoc in thesedocs %}
  <li>
    <a title="{{adoc}}" href="#">{{adoc}}</a>
    {% assign chapnums =  site.pages | where: 'libname', page.libname | sort: 'chapnum' | map: 'chapnum' | uniq | compact %}
    {% assign chapnames = site.pages | where: 'libname', page.libname | sort: 'chapnum' | map: 'chapnam' | uniq | compact %}
    <ul>
      {% for chapnum in chapnums %}
        <li class="subfolders">
        <a title="{{ chapnames[forloop.index0] }}" href="#"> {{chapnames[forloop.index0]}} </a>
          <ul>
          {% assign pagenames = site.pages | where: 'libname', page.libname | where: 'chapnum', chapnums[forloop.index0] | sort: 'pagenum' | map: 'title' | uniq | compact %}
          {% assign pageurls = site.pages | where: 'libname', page.libname | where: 'chapnum', chapnums[forloop.index0] | sort: 'pagenum' | map: 'url' | uniq | compact %}
          {% for apage in pagenames %}
            {% if page.chapnum == chapnum %}
              {% if page.title == apage %}
                <li class="active"><a title="{{apage}}" href="{{pageurls[forloop.index0] | remove: "/"}}">visible {{apage}}</a></li>
              {% elseif %}
                <li><a title="{{apage}}" href="{{pageurls[forloop.index0] | remove: "/"}}">visible {{apage}}</a></li>
              {% endif %}
            {% elseif %}
              <li><a title="{{apage}}" href="{{pageurls[forloop.index0] | remove: "/"}}">visible {{apage}}</a></li>
            {% endif %}
          {% endfor %} 
          </ul>
        </li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>


