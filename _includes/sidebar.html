<!--
lvl1 = topnav button name
lvl2 = sidebar name (same as topnav dropdown list entry, e.g. book or article)
lvl3 = 1st level of entries in sidebar  (eg section or chapter)
lvl4 = 2nd level of entries in sidebar  (eg chapter or page )
lvl5 = 3rd level of entries in sidebar  (e.g  page)
-->

<div class="mydocsidebar background-color: whitesmoke;">
   <div class="sidebar-inner background-color: whitesmoke;">
      {% unless page.sidebar == null %}
         {% assign sbtitle = site.pages | where: 'l1idx', page.l1idx | where: 'l2idx', page.l2idx | map: 'l2name' | compact | uniq %}
         <div class="productTitle">{{sbtitle}} </div>
      {% endunless %}
      {% unless page.url contains 'index.html' %}
         <ul id="docnavsidebar" class="docnav">
            <!-- Get a list of all pages with l1/l2/l3.idx values that match *this* page.  (these are all the pages that should be in the sidebar)  -->
            {% assign sbpages = site.pages | where: 'l1idx', page.l1idx | where: 'l2idx', page.l2idx | sort: '13idx' %}
            {% if sbpages %}
               <!-- Get a list of all the unique/sorted l3 indices and names from sidebar pages -->
               {% assign sbl3idxes = sblpages | map: 'l3idx' | compact | uniq | sort: 'l3idx' %}
               {% assign sbl3names = sbl3pages | map: 'l3name' | compact | uniq | sort: 'l3idx' %}
               <!-- Loop through the list of unique L3 indexes/names and create navbar/list entries for each -->
               {% for sbl3idx in sbl3idxes %}
                  <li>
                     <a>{{sbl3name in sbl3idx[forloop.index0]}}</a>
                  </li>
               {% endfor %}
            {% endif %}
         </ul>
      {% endunless %}
   </div>
</div>